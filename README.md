# DiplomSF54 - Ansible Playbooks for Diploma

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç **Ansible Playbooks** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —Ä–∞–º–∫–∞—Ö –¥–∏–ø–ª–æ–º–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.  

### **–°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**
#### **1Ô∏è‚É£ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Å–µ—Ä–≤–µ—Ä (`monitoring`)**
- **Zabbix Server**
- **Grafana**
- **Filebeat**
- **OpenVPN (—Å–µ—Ä–≤–µ—Ä)**

#### **2Ô∏è‚É£ –í–µ–±-—Å–µ—Ä–≤–µ—Ä (`web`)**
- **Nginx**
- **Apache**
- **PHP**
- **Zabbix Agent**
- **Filebeat**
- **Bind (DNS)**
- **Mail-—Å–µ—Ä–≤–µ—Ä**

#### **3Ô∏è‚É£ –°–µ—Ä–≤–µ—Ä –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (`database`)**
- **PostgreSQL-12**
- **Zabbix Agent**
- **ELK (Elasticsearch, Logstash, Kibana)**

---

## üìå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### **1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
```bash
git clone https://github.com/YOUR_USERNAME/ansible-diploma.git
cd ansible-diploma
```
(–∑–∞–º–µ–Ω–∏ `YOUR_USERNAME` –Ω–∞ —Å–≤–æ–π GitHub-–∞–∫–∫–∞—É–Ω—Ç)

### **2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ansible**
–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `ansible.cfg`, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è:
```ini
[defaults]
inventory = ./hosts
remote_user = ansible
ask_pass = false
```
–£–±–µ–¥–∏—Å—å, —á—Ç–æ `inventory.ini` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.

### **3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –ø–ª–µ–π–±—É–∫–æ–≤**
#### üîπ **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
ansible-playbook -i inventory.ini site.yml
```
#### üîπ **–ó–∞–ø—É—Å–∫ –≤ `--check` (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏)**
```bash
ansible-playbook -i inventory.ini site.yml --check
```
#### üîπ **–ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞**
```bash
ansible-playbook -i inventory.ini site.yml --limit web
```
(–ó–∞–º–µ–Ω–∏—Ç–µ `web` –Ω–∞ `monitoring` –∏–ª–∏ `database`, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

#### üîπ **–ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–æ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Grafana)**
```bash
ansible-playbook -i inventory.ini site.yml --tags grafana
```

---

## üìå –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
/etc/ansible
‚îÇ‚îÄ‚îÄ ansible.cfg             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ansible
‚îÇ‚îÄ‚îÄ hosts                   # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–µ—Ä–≤–µ—Ä–æ–≤
‚îÇ‚îÄ‚îÄ site.yml                # –ì–ª–∞–≤–Ω—ã–π playbook
‚îÇ‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ‚îÄ‚îÄ roles/                  # –ö–∞—Ç–∞–ª–æ–≥ —Ä–æ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ zabbix_server/      # –†–æ–ª—å Zabbix Server
‚îÇ   ‚îú‚îÄ‚îÄ grafana/            # –†–æ–ª—å Grafana
‚îÇ   ‚îú‚îÄ‚îÄ filebeat/           # –†–æ–ª—å Filebeat
‚îÇ   ‚îú‚îÄ‚îÄ openvpn/            # –†–æ–ª—å OpenVPN
‚îÇ   ‚îú‚îÄ‚îÄ nginx/              # –†–æ–ª—å Nginx
‚îÇ   ‚îú‚îÄ‚îÄ apache/             # –†–æ–ª—å Apache
‚îÇ   ‚îú‚îÄ‚îÄ php/                # –†–æ–ª—å PHP
‚îÇ   ‚îú‚îÄ‚îÄ zabbix_agent/       # –†–æ–ª—å Zabbix Agent
‚îÇ   ‚îú‚îÄ‚îÄ bind/               # –†–æ–ª—å Bind DNS
‚îÇ   ‚îú‚îÄ‚îÄ mail/               # –†–æ–ª—å Mail
‚îÇ   ‚îú‚îÄ‚îÄ postgresql/         # –†–æ–ª—å PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ elk/                # –†–æ–ª—å ELK Stack
‚îÇ‚îÄ‚îÄ group_vars/             # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä—É–ø–ø —Ö–æ—Å—Ç–æ–≤
‚îÇ‚îÄ‚îÄ host_vars/              # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤
‚îÇ‚îÄ‚îÄ playbooks/              # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ playbooks
‚îî‚îÄ‚îÄ .gitignore              # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
```

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø–ª–µ–π–±—É–∫–æ–≤

| **–ü–ª–µ–π–±—É–∫**    | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|---------------|-------------|
| `site.yml` | –ì–ª–∞–≤–Ω—ã–π Ansible Playbook, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ä–æ–ª–∏ |
| `roles/grafana/tasks/main.yml` | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Grafana |
| `roles/elk/tasks/main.yml` | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Elasticsearch, Logstash –∏ Kibana |
| `roles/openvpn/tasks/main.yml` | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç OpenVPN-—Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ |

---

## üìå –†–∞–±–æ—Ç–∞ —Å OpenVPN
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
ansible-playbook -i inventory.ini roles/openvpn/tasks/main.yml
```
**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ OpenVPN:**
```bash
systemctl status openvpn
```
**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ VPN:**
```bash
ansible-playbook -i inventory.ini roles/openvpn/tasks/add_client.yml
```

---

## üìå –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Ansible?
–ù–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `mentor2`) —á–µ—Ä–µ–∑ Ansible:
```bash
ansible all -m user -a "name=mentor2 password=$(openssl passwd -1 sf54) shell=/bin/bash" --become
```
(–ü–∞—Ä–æ–ª—å `sf54` )

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
‚úÖ **–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**  
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç Ansible-—Ä–æ–ª–∏–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏ –≥–∏–±–∫–æ—Å—Ç–∏**  
‚úÖ **–ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —á–µ—Ä–µ–∑ GitHub**  

